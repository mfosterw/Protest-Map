<!DOCTYPE html>
<html>

<head>
  <title>Floyd Protest Map</title>
  <meta name="viewport" content="initial-scale=1.0">
  <meta charset="utf-8">
  <style>
    #map {
      height: 100%;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
</head>

<body>
  <div id="map"></div>
  <script>
    var map;
    var infowindow;

    function initMap() {
      //Create map centered on continental US
      map = new google.maps.Map(document.getElementById('map'), {
        center: {
          lat: 39.83,
          lng: -98.583
        },
        zoom: 4.5
      });
      map.data.loadGeoJson('https://raw.githubusercontent.com/mfosterw/Protest-Map/master/scripts/files/geoprotest.json')

      map.data.setStyle(function(feature){
        return {'title': feature.getProperty('title')};
      });

      infowindow = new google.maps.InfoWindow({});

      //Add infowindow popup to each marked point
      map.data.addListener('click', function(event) {
        var content = `<h1>${event.feature.getProperty("title")}</h1><hr />
        <p>${event.feature.getProperty("time_info")}</p>
        <p>${event.feature.getProperty("location")}</p><p>&nbsp;</p>
        <p>${event.feature.getProperty("notes")}</p>
        <p><a href="${event.feature.getProperty("url")}", target="blank">
        Source</a></p>`;

        //Adapted from https://stackoverflow.com/questions/48138226/google-maps-geojson-infowindow
        infowindow.setContent(content);
        infowindow.setPosition(event.feature.getGeometry().get());
        infowindow.setOptions({
          pixelOffset: new google.maps.Size(0, -30)
        });
        infowindow.open(map);
      });
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAbhE2UHcmRKmq14Rk-TODAHKVwGkV5xG4&callback=initMap" async defer></script>
</body>

</html>
